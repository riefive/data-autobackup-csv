!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="dist/",a(a.s=6)}([function(e,t){e.exports=require("sequelize")},function(e,t,a){"use strict";e.exports={getNodeEnv:function(){let e="production";return e},jsonToArray:function(e){return JSON.parse(JSON.stringify(e,null,4))}}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("inquirer")},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("fs")},function(e,t,a){"use strict";const n=a(2),r=a(3),i=a(4),s=a(7),o=a(8),c=a(9),u=a(10),l=a(11),d=a(12),p=a(13),m=a(15),f=a(17),y=a(18),h=a(23),g=a(27),b=a(28),w=a(1),k=a(30),_=new y(n.resolve(process.cwd(),"config.dfg")),S=new h;let v=_.read(!0),N=new g(v);const T=()=>{b.clear(),setTimeout(()=>{process.exit(1)},1e3)},j=()=>{(v=_.read(!0)).hasOwnProperty("data")||O("database"),S.start(),(async()=>{try{const e=f({hostname:v.data.host,username:v.data.username,password:v.data.password,database:v.data.database,engine:v.data.engine});await e.sync({force:!1});const t=s(e),a=o(e),n=c(e),r=l(e),y=d(e),h=u(e);y.belongsTo(r,{foreignKey:"id_barang"}),y.belongsTo(h,{foreignKey:"id_toko"}),r.belongsTo(t,{foreignKey:"id_category"}),r.belongsTo(a,{foreignKey:"id_merk"}),r.hasMany(y,{foreignKey:"id_barang",as:"details"}),h.hasOne(y,{foreignKey:"id_toko",as:"store"}),t.belongsTo(n,{foreignKey:"id_jenis"}),t.hasOne(r,{foreignKey:"id_category",as:"category"}),a.hasOne(r,{foreignKey:"id_merk",as:"merk"}),n.hasOne(t,{foreignKey:"id_jenis",as:"type"}),b.main(async function(e=5){e=isNaN(parseInt(e))?100:parseInt(e);const i=await p.getAll({Category:t,Merk:a,Type:n,Store:h,Product:r,ProductDetail:y},e);let s=m.getProduct(i);S.writefile("product",s.csv),k.info("Menyimpan produk dalam format csv")},[v.limit],v.interval)}catch(e){let t=w.jsonToArray(e);throw i.has(t,"parent.syscall")&&k.warn(`${t.parent.code}: ${t.parent.syscall}`),i.has(t,"parent.sqlMessage")&&k.warn(`${t.parent.code}: ${t.parent.sqlMessage}`),JSON.stringify(t,null,4)}})()},O=async(e=null)=>{v=_.read(!0),N.update(v);let t=v.publickey,a=v.secondkey,n=(t.split("").reverse().join(""),a.split("").reverse().join(""),null),i=null,s=null;if(null===e){let t=await r.prompt(N.main());e=null!==t&&t.hasOwnProperty("menu")?t.menu:"exit"}switch(e){case"database":(n=await r.prompt(N.database())).isdatabase&&(i={host:n.host,database:n.database,username:n.username,password:n.password,engine:"mysql"},s=_.read(),_.save(s,{data:_.encodechild(i,t,a)})),O();break;case"folder":(n=await r.prompt(N.folder())).isfolder&&(s=_.read(),_.save(s,{folder:n.folder})),O();break;case"limit":(n=await r.prompt(N.limit())).islimit&&(s=_.read(),_.save(s,{limit:n.limit})),O();break;case"interval":if((n=await r.prompt(N.interval())).isinterval){let e=0;switch(n.interval){case"1menit":e=60;break;case"5menit":e=300;break;case"15menit":e=900;break;case"30menit":e=1800;break;case"1jam":e=3600;break;case"3jam":e=10800;break;case"5jam":e=18e3;break;case"12jam":e=43200;break;default:e=5}s=_.read(),_.save(s,{interval:String(e)})}O();break;case"exit":T();break;default:k.info("Menjalankan perintah download"),j()}};process.on("SIGTERM",T),process.on("SIGINT",T),process.on("unhandledRejection",e=>{if(!i.isEmpty(e))throw console.log("unhandled-rejection"),JSON.stringify(e,null,4)}),O()},function(e,t,a){"use strict";const n=a(0);e.exports=function(e){return e.define("category",{id_category:{type:n.STRING(20),primaryKey:!0},nama_category:{type:n.STRING(30)},id_jenis:{type:n.STRING(20)}},{timestamps:!1,underscored:!1,freezeTableName:!0,tableName:"category"})}},function(e,t,a){"use strict";const n=a(0);e.exports=function(e){return e.define("merk",{id_merk:{type:n.STRING(20),primaryKey:!0},nama_merk:{type:n.STRING(40)},time:{type:n.INTEGER}},{timestamps:!1,underscored:!1,freezeTableName:!0,tableName:"merk"})}},function(e,t,a){"use strict";const n=a(0);e.exports=function(e){return e.define("type",{id_jenis:{type:n.STRING(20),primaryKey:!0},nama_jenis:{type:n.STRING(30)}},{timestamps:!1,underscored:!1,freezeTableName:!0,tableName:"jenis"})}},function(e,t,a){"use strict";const n=a(0);e.exports=function(e){return e.define("store",{id_toko:{type:n.STRING(45),primaryKey:!0},nama_toko:{type:n.STRING(30)},alamat:{type:n.TEXT}},{timestamps:!1,underscored:!1,freezeTableName:!0,tableName:"toko"})}},function(e,t,a){"use strict";const n=a(0);e.exports=function(e){return e.define("product",{id_barang:{type:n.STRING(30),primaryKey:!0},id_merk:{type:n.STRING(20)},id_category:{type:n.STRING(20)},nama_barang:{type:n.STRING(50)},harga_jual:{type:n.INTEGER}},{timestamps:!1,underscored:!1,freezeTableName:!0,tableName:"barang"})}},function(e,t,a){"use strict";const n=a(0);e.exports=function(e){return e.define("product_detail",{id_barang:{type:n.STRING(20),primaryKey:!0},id_toko:{type:n.STRING(20),primaryKey:!0},jumlah:{type:n.INTEGER},harga_beli:{type:n.INTEGER}},{timestamps:!1,underscored:!1,freezeTableName:!0,tableName:"barang_detail"})}},function(e,t,a){"use strict";const{jsonToArray:n}=a(1),{getCategory:r,getMerk:i,getType:s}=a(14);e.exports={getAll:async function(e,t=1e4){const a=await e.Product.findAll({include:[{model:e.Category,include:[{model:e.Type}]},{model:e.Merk},{model:e.ProductDetail,as:"details",include:[{model:e.Store}]}],order:[["id_barang","ASC"]],limit:t}),o=[],c=n(a);for(let t=0;t<1;t++){const a=c[t],u=await r(e.Category,a.id_category),l=n(u),d=await i(e.Merk,a.id_merk),p=n(d),m=await s(e.Type,l.id_jenis),f=n(m);o.push(Object.assign({nama_category:l.nama_category,nama_jenis:f.nama_jenis,nama_merk:p.nama_merk},a))}return c}}},function(e,t,a){"use strict";e.exports={getCategory:async function(e,t){try{return await e.findOne({where:{id_category:t}})}catch(e){throw e}},getMerk:async function(e,t){try{return await e.findOne({where:{id_merk:t}})}catch(e){throw e}},getType:async function(e,t){try{return await e.findOne({where:{id_jenis:t}})}catch(e){throw e}},getStore:async function(e,t){try{return await e.findOne({where:{id_toko:t}})}catch(e){throw e}}}},function(e,t,a){"use strict";const n=a(16);e.exports={getProduct:function(e){let t=[];const a=["Id barang","Nama Merk","Nama Kategori","Jenis","Nama Barang","Id Toko","Nama Toko","Harga Jual","Harga Beli","Jumlah"];for(let a=0;a<e.length;a++){const n=e[a];let r={id_barang:n.id_barang,nama_merk:n.hasOwnProperty("merk")?n.merk.nama_merk:"",nama_kategori:n.hasOwnProperty("category")?n.category.nama_category:"",jenis:n.hasOwnProperty("category")?n.category.type.nama_jenis:"",nama_barang:n.nama_barang,id_toko:null,nama_toko:null,harga_jual:n.harga_jual,harga_beli:0,jumlah:0};if(n.details.length>0)for(const e of n.details){let a={id_barang:e.id_barang,id_toko:e.id_toko,nama_toko:e.store.nama_toko,harga_beli:e.harga_beli,jumlah:e.jumlah};r=Object.assign({},r,a),t.push(Object.values(r))}else t.push(Object.values(r))}return{raw:t,cols:a,csv:n.unparse({fields:a,data:t})}}}},function(e,t){e.exports=require("papaparse")},function(e,t,a){"use strict";const n=a(0);e.exports=(e=>{if(null===e)throw new Error("Option can`t be null");let t=e.hasOwnProperty("database")?e.database:"",a=e.hasOwnProperty("username")?e.username:"",r=e.hasOwnProperty("password")?e.password:"",i=e.hasOwnProperty("hostname")?e.hostname:"",s=e.hasOwnProperty("engine")?e.engine:"mysql";return new n(t,a,r,{host:i,dialect:s,operatorsAliases:!1,logging:!1,pool:{max:5,min:0,acquire:3e4,idle:1e4}})})},function(e,t,a){"use strict";const n=a(5),r=a(19),i=a(20),s=a(21),{getNodeEnv:o}=a(1);e.exports=class{constructor(e){this.source=e,this.crypt=new s}initchild(e,t){return"production"===o()&&(e=e.split("").reverse().join(""),t=t.split("").reverse().join("")),{public:e,second:t}}encodechild(e,t,a){let n=this.initchild(t,a),i=e;return i.hasOwnProperty("username")&&(i.username=this.crypt.encodesync(i.username,n.second)),i.hasOwnProperty("password")&&(i.password=this.crypt.encodesync(i.password,n.second)),r.sign(i,n.public)}decodechild(e,t,a){let n=this.initchild(t,a),i=r.verify(e,n.public);return i.hasOwnProperty("username")&&(i.username=this.crypt.decodesync(i.username,n.second)),i.hasOwnProperty("password")&&(i.password=this.crypt.decodesync(i.password,n.second)),i}read(e=!1){let t=null;if(n.existsSync(this.source)&&n.statSync(this.source).isFile()){const a=n.readFileSync(this.source,"utf8");let r=(t=JSON.parse(a.toString())).hasOwnProperty("publickey")?t.publickey:"",i=t.hasOwnProperty("secondkey")?t.secondkey:"";if(e&&t.hasOwnProperty("data")){let e=this.decodechild(t.data,r,i);t.data=e}}else{t={limit:"10",interval:"60",publickey:i.finance.bitcoinAddress(),secondkey:i.finance.iban()};try{n.writeFileSync(this.source,JSON.stringify(t,null,4),"utf8")}catch(e){throw JSON.stringify(e,null,4)}}return t}save(e,t){let a=Object.assign(e,t);try{n.writeFileSync(this.source,JSON.stringify(a,null,4),"utf8")}catch(e){throw JSON.stringify(e,null,4)}}}},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("faker")},function(e,t,a){"use strict";const n=a(22);e.exports=class{encode(e,t,a){const r=n.createCipher("aes192",t);let i="";r.on("readable",()=>{const e=r.read();e&&(i+=e.toString("hex"))}),r.on("end",()=>{a(i)}),r.write(e),r.end()}encodesync(e,t){const a=n.createCipher("aes192",t);let r=a.update(e);return r+=a.final("hex")}decode(e,t,a){const r=n.createDecipher("aes192",t);let i="";r.on("readable",()=>{const e=r.read();e&&(i+=e.toString("utf8"))}),r.on("end",()=>{a(i)}),r.write(e,"hex"),r.end()}decodesync(e,t){const a=n.createDecipher("aes192",t);let r=a.update(e,"hex","utf8");return r+=a.final("utf8")}}},function(e,t){e.exports=require("crypto")},function(e,t,a){"use strict";const n=a(5),r=a(2),i=a(24),s=a(25),o=a(26).promisifyAll(n),c=r.resolve(process.cwd(),"backup");e.exports=class{constructor(){this.init()}getpath(e){return Array.isArray(e)?r.resolve.apply(null,[...new Set([c,...e])]):r.resolve(c,e)}getsubpath(e){let t=s().format("MM"),a=s().format("DD-MM-YYYY");return[...new Set([...this.childfolder[parseInt(t)-1],`${e}-${a}.csv`])]}makefolder(e){let t=this.getpath(e);if(!o.existsSync(t))return o.mkdirAsync(t)}writefile(e,t){return o.writeFileAsync(this.getpath(this.getsubpath(e)),t)}init(){let e=s().format("YYYY");this.subfolder=`file-${e}`,this.childfolder=[];for(let t=1;t<=12;t++){let a=String(t).padStart(2,"0"),n=i.format("%s-%s-%s",e,a,"01"),r=s(n).format("MMM");this.childfolder.push([this.subfolder,`${a}-${r.toLowerCase()}`])}}start(){n.existsSync(c)||o.mkdirAsync(c),setTimeout(()=>{this.makefolder(this.subfolder)},100),setTimeout(()=>{for(let e=0;e<this.childfolder.length;e++){const t=this.childfolder[e];this.makefolder(t)}},500)}}},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("bluebird")},function(e,t,a){"use strict";const n=a(3),r=a(4);function i(e){return/\S+/.test(e)||"Silahkan masukan teks"}function s(e,t,a){let n=e.hasOwnProperty(t),r=e.hasOwnProperty(a),i=n&&!0===e[t],s=r&&null!==e[a]&&""!==e[a].trim();return i&&s}e.exports=class{constructor(e){this.config=e}update(e){this.config=e}main(){return[{type:"list",name:"menu",message:"Pilih perintah konfigurasi dibawah ini.",choices:["database","folder","limit","interval","start",new n.Separator,"exit"]}]}database(){let e="localhost",t="data",a="root",n="";return r.has(this.config,"data")&&(e=r.has(this.config.data,"host")?this.config.data.host:e,t=r.has(this.config.data,"database")?this.config.data.database:t,a=r.has(this.config.data,"username")?this.config.data.username:a,n=r.has(this.config.data,"password")?this.config.data.password:n),[{type:"confirm",name:"isdatabase",message:"Ingin mengatur kembali konfigurasi database?",default:!1},{type:"input",name:"host",message:"Lokasi host database Anda?",default:e,validate:function(e){return i(e)},when:function(e){return!0===e.isdatabase}},{type:"input",name:"database",message:"Nama database Anda?",default:t,validate:function(e){return i(e)},when:function(e){return s(e,"isdatabase","host")}},{type:"input",name:"username",message:"Nama user database Anda?",default:a,validate:function(e){return i(e)},when:function(e){return s(e,"isdatabase","database")}},{type:"password",name:"password",message:"Kata sandi database Anda?",default:n,mask:"*",validate:function(e){return i(e)},when:function(e){return s(e,"isdatabase","username")}}]}folder(){return[{type:"confirm",name:"isfolder",message:"Ingin mengatur kembali konfigurasi nama folder backup?",default:!1},{type:"input",name:"folder",message:"Nama lokasi folder backup?",default:r.has(this.config,"folder")?this.config.backup:"backup",filter:function(e){return e.toLowerCase()},validate:function(e){return i(e)},when:function(e){return!0===e.isfolder}}]}limit(){return[{type:"confirm",name:"islimit",message:"Ingin mengatur kembali konfigurasi limit?",default:!1},{type:"list",name:"limit",message:"Jumlah data maksimal yang diambil?",choices:["10","15","25","50","100","250","500","1000","5000","10000","100000"],default:r.has(this.config,"limit")?this.config.limit:"10000",validate:function(e){return function(e){return!isNaN(parseInt(e))||"Silahkan masukan angka"}(e)},when:function(e){return!0===e.islimit}}]}interval(){return[{type:"confirm",name:"isinterval",message:"Ingin mengulangi pengaturan konfigurasi interval?",default:!1},{type:"list",name:"interval",message:"Berapa lama waktu timer interval?",choices:["1menit","5menit","15menit","30menit","1jam","3jam","5jam","12jam"],filter:function(e){return e.toLowerCase()},when:function(e){return!0===e.isinterval}}]}}},function(e,t,a){"use strict";let n=new(a(29));e.exports={timer:n,main:function(e,t,a=10){n.setInterval(e,t,`${a}s`)},mainsecond:function e(t,a,r=10){n.setTimeout(t,a,`${r}s`,n=>{let i=n.waitTime/Math.pow(10,9);Logger.info(`elapsed time ${i}`),e(t,a,`${r}s`)})},clear:function(){n.clearInterval()},clearsecond:function(){n.clearTimeout()}}},function(e,t){e.exports=require("nanotimer")},function(e,t,a){"use strict";const n=a(2),{createLogger:r,format:i,transports:s}=a(31),{getNodeEnv:o}=a(1);a(32);const c=Symbol.for("message"),u=n.resolve(process.cwd(),"backup","log"),l=r({format:i(e=>{const t={timestamp:new Date},a=Object.assign(t,e);return e[c]=JSON.stringify(a),e})(),silent:"production"===o(),transports:[new s.DailyRotateFile({filename:n.resolve(u,"backup-%DATE%.log"),datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"5m"})]});e.exports=l},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("winston-daily-rotate-file")}]);